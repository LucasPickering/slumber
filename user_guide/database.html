<!--
Copied from https://github.com/rust-lang/mdBook/blob/v0.4.43/src/theme/index.hbs
Overridden to remove prev/next page buttons because they're big and useless
-->


<!DOCTYPE HTML>
<html lang="en" class="dark sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Database &amp; Persistence - Slumber</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Slumber is a TUI (terminal user interface) HTTP client. Define, execute, and share configurable HTTP requests.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/pagetoc.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "dark";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Slumber</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/LucasPickering/slumber" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/LucasPickering/slumber/edit/master/docs/src/user_guide/database.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="database--persistence"><a class="header" href="#database--persistence">Database &amp; Persistence</a></h1>
<blockquote>
<p>Note: This is an advanced feature. The vast majority of users can use Slumber all they want without even knowing the database exists.</p>
</blockquote>
<p>Slumber uses a <a href="https://www.sqlite.org/">SQLite</a> database to persist requests and responses. The database also stores UI state that needs to be persisted between sessions. This database exists exclusively on your device. <strong>The Slumber database is never uploaded to the cloud or shared in any way.</strong> Slumber does not make any network connections beyond the ones you define and execute yourself. You own your data; I don't want it.</p>
<p>Data for all your Slumber collections are stored in a single file. To find this file, run <code>slumber show paths</code>, and look for the <code>Database</code> entry. I encourage you to browse this file if you're curious; it's pretty simple and there's nothing secret in it. Keep in mind though that <strong>the database format is NOT considered part of Slumber's API contract.</strong> It may change at any time, including the database path moving or tables be changed or removed, even in a minor or patch release.</p>
<h3 id="controlling-persistence"><a class="header" href="#controlling-persistence">Controlling Persistence</a></h3>
<p>By default, all requests made in the TUI are stored in the database. This enables the history browser, allowing you to browse past requests. While generally useful, this may not be desired in all cases. However, there are some cases where you may not want requests persisted:</p>
<ul>
<li>The request or response may contain sensitive data</li>
<li>The response is very large and impacts app performance</li>
</ul>
<p>You can disable persistence for a single recipe by setting <code>persist: false</code> <a href="../api/request_collection/request_recipe.html#recipe-fields">for that recipe</a>. You can disable history globally by setting <code>persist: false</code> in the <a href="../api/configuration/index.html">global config file</a>. Note that this only disables <em>request</em> persistence. UI state, such as selection state for panes and checkboxes, is still written to the database.</p>
<blockquote>
<p><strong>NOTE:</strong> Disabling persistence does <em>not</em> delete existing request history. <a href="#deleting-request-history">See here</a> for how to do that.</p>
</blockquote>
<p>Slumber will generally continue to work just fine with request persistence disabled. Requests and responses are still cached in memory, they just aren't written to the database anymore and therefore can't be recovered after the current session is closed. If you disable persistence, you will notice a few impacts on functionality:</p>
<ul>
<li>The history modal will only show requests made during the current session</li>
<li>Chained requests can only access responses from the current session. <a href="../api/template_functions.html#response">Consider adding <code>trigger="no_history"</code> to the <code>response</code> call</a> to automatically refetch it on new sessions.</li>
</ul>
<p>Unlike the TUI, requests made from the CLI are <em>not</em> persisted by default. This is because the CLI is often used for scripting and bulk requests. Persisting these requests could have major performance impacts for little to no practical gain. Pass the <code>--persist</code> flag to <code>slumber request</code> to persist a CLI request.</p>
<h3 id="deleting-request-history"><a class="header" href="#deleting-request-history">Deleting Request History</a></h3>
<p>There are a few ways to delete requests from history:</p>
<ul>
<li>In the TUI. Open the actions menu while a request/response is selected to delete that request. From the recipe list/recipe pane, you can delete all requests for that recipe.</li>
<li><code>slumber history delete</code> can delete one or more commands at a time. Combine with <code>slumber history list</code> for bulk deletes: <code>slumber history list login --id-only | xargs slumber history delete</code></li>
<li><code>slumber collections delete</code> can delete all history for a single collection. If you have an old collection that you no longer use, you can delete it from the list using this command. <strong>Note:</strong> If you moved a collection file and want to remove the old file's history, you can also <a href="#migrating-collections">migrate the history to the new file location</a>.</li>
<li>Manually modifying the database. You can access the DB with <code>slumber db</code>. While this is not an officially supported technique (as the DB schema may change without warning), it's simple enough to navigate if you want to performance bulk deletes with custom criteria.</li>
</ul>
<h3 id="migrating-collections"><a class="header" href="#migrating-collections">Migrating Collections</a></h3>
<p>As all Slumber collections' histories are stored in the same SQLite database, each collection gets a unique <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a> generated when it is first accessed. This UUID is used to persist request history and other data related to the collection. This UUID is bound to the collection's path. If you move a collection file, a new UUID will be generated and it will be unlinked from its previous history. If you want to retain that history, you can migrate data from the old ID to the new one like so:</p>
<pre><code class="language-sh">slumber collections migrate slumber-old.yml slumber-new.yml
</code></pre>
<p>If you don't remember the path of the old file, you can list all known collections with:</p>
<pre><code class="language-sh">slumber collections list
</code></pre>

                    </main>
                </div>
            </div>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/pagetoc.js"></script>


    </div>
    </body>
</html>
